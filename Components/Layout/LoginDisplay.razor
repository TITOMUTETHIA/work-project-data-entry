@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager Nav
@inject AuthenticationStateProvider AuthStateProvider

<AuthorizeView Context="auth">
    <Authorized>
        <span class="me-2">Hello, @auth.User.Identity?.Name</span>
        <button class="btn btn-link" @onclick="Logout">Logout</button>
    </Authorized>
    <NotAuthorized>
        <a class="nav-link" href="/login">Login</a>
        <a class="nav-link" href="/register">Register</a>
    </NotAuthorized>
</AuthorizeView>

@code {
    private async Task Logout()
    {
        await Http.PostAsync("/auth/logout", null);
        // Force a full reload so server auth cookie state is refreshed
        Nav.NavigateTo("/", true);
    }

    [Inject] private HttpClient Http { get; set; } = default!;
}
